angular.module("umbraco").controller("Umbraco.Community.Contentment.DataEditors.Buttons.Controller",["$scope",function(n){function u(){n.model.value=n.model.value||i.defaultValue;Array.isArray(n.model.value)===!1&&(n.model.value=[n.model.value]);t.multiple=Object.toBoolean(i.enableMultiple);t.multiple===!1&&n.model.value.length>0&&n.model.value.splice(1);t.items=i.items.slice();t.hideIcon=i.labelStyle==="text";t.hideName=i.labelStyle==="icon";t.uniqueId=n.model.hasOwnProperty("dataTypeKey")?[n.model.alias,n.model.dataTypeKey.substring(0,8)].join("-"):n.model.alias;t.size=i.size;t.defaultIcon=i.defaultIcon;t.iconExtras=(t.hideName===!1?" mr2 ":" mr0 ")+{s:"small",m:"medium",l:"large"}[i.size];t.items.forEach(function(t){t.selected=n.model.value.indexOf(t.value)>-1});t.select=e;n.umbProperty&&(t.propertyActions=[],Object.toBoolean(i.allowClear)===!0&&t.propertyActions.push({labelKey:"buttons_clearSelection",icon:"trash",method:f}),t.propertyActions.length>0&&n.umbProperty.setPropertyActions(t.propertyActions))}function f(){n.model.value=[];t.items.forEach(n=>n.selected=!1);r()}function e(i){i.selected=i.selected===!1;n.model.value=[];t.items.forEach(function(r){t.multiple===!1&&(r.selected=r.value===i.value);r.selected&&n.model.value.push(r.value)});r()}function r(){n.propertyForm&&n.propertyForm.$setDirty()}var i=Object.assign({},{allowClear:0,defaultIcon:"icon-science",defaultValue:[],items:[],enableMultiple:0,labelStyle:"both",size:"m"},n.model.config),t=this;u()}]);angular.module("umbraco.filters").filter("formatBytes",function(){return function(n,t){if(n===0||t===undefined)return"0 Bytes";const i=parseInt(t.kilo)||1024,u=parseInt(t.decimals)||0,r=Math.floor(Math.log(n)/Math.log(i));return parseFloat((n/Math.pow(i,r)).toFixed(u))+" "+["Bytes","KB","MB","GB","TB","PB","EB","ZB","YB"][r]}});angular.module("umbraco").controller("Umbraco.Community.Contentment.DataEditors.CascadingDropdownList.Controller",["$scope","$q","$http",function(n,t,i){function f(){var h,f,s,o;if(n.model.value=n.model.value||u.defaultValue,r.dropdowns=[],u.apis.length>0){for(r.loading=!0,h=[],f=0;f<n.model.value.length;f++){for(s=u.apis[f],o=0;o<f;o++)s=s.replace("{"+o+"}",n.model.value[o]);h.push(i({method:"GET",url:s}))}t.all(h).then(function(n){n&&n.forEach(function(n,t){r.dropdowns[t]={options:n.data}});r.loading=!1})}r.change=e}function e(t){var f=t+1,e;u.apis.length>f&&(r.loading=!0,e=u.apis[f].replace(/{(\d+)}/g,function(t,i){return typeof n.model.value[i]!="undefined"?n.model.value[i]:t}),i({method:"GET",url:e}).then(function(n){r.dropdowns[f]={options:n.data};r.loading=!1}));o()}function o(){n.propertyForm&&n.propertyForm.$setDirty()}if(!n.model.hasOwnProperty("contentTypeId")){var u=Object.assign({},{apis:[],defaultValue:[""]},n.model.config),r=this;f()}}]);angular.module("umbraco").controller("Umbraco.Community.Contentment.DataEditors.CheckboxList.Controller",["$scope",function(n){function u(){n.model.value=n.model.value||i.defaultValue;Array.isArray(n.model.value)===!1&&(n.model.value=[n.model.value]);t.items=i.items.slice();t.items.forEach(function(t){t.checked=n.model.value.indexOf(t.value)>-1});t.showDescriptions=Object.toBoolean(i.showDescriptions);t.showIcons=Object.toBoolean(i.showIcons);t.uniqueId=n.model.hasOwnProperty("dataTypeKey")?[n.model.alias,n.model.dataTypeKey.substring(0,8)].join("-"):n.model.alias;t.changed=f;t.toggleAll=Object.toBoolean(i.checkAll);t.toggleAll&&(t.toggle=e,t.toggleChecked=t.items.every(function(n){return n.checked}))}function f(){t.toggleChecked=t.items.every(function(n){return n.checked});n.model.value=[];t.items.forEach(function(t){t.checked&&n.model.value.push(t.value)});r()}function e(){n.model.value=[];t.items.forEach(function(i){i.disabled||(i.checked=t.toggleChecked,i.checked&&n.model.value.push(i.value))});r()}function r(){n.propertyForm&&n.propertyForm.$setDirty()}var i=Object.assign({},{items:[],checkAll:0,showDescriptions:0,showIcons:0,defaultValue:[]},n.model.config),t=this;u()}]);angular.module("umbraco").controller("Umbraco.Community.Contentment.DataEditors.CodeEditor.Controller",["$scope",function(n){function u(){i.readonly=Object.toBoolean(t.readonly);i.options={autoFocus:!1,showGutter:Object.toBoolean(t.showGutter),useWrapMode:Object.toBoolean(t.useWrapMode),showInvisibles:Object.toBoolean(t.showInvisibles),showIndentGuides:Object.toBoolean(t.showIndentGuides),useSoftTabs:Object.toBoolean(t.useSoftTabs),showPrintMargin:Object.toBoolean(t.showPrintMargin),disableSearch:Object.toBoolean(t.disableSearch),theme:t.theme,mode:t.mode,firstLineNumber:t.firstLineNumber,advanced:{fontSize:t.fontSize,enableSnippets:Object.toBoolean(t.enableSnippets),enableBasicAutocompletion:Object.toBoolean(t.enableBasicAutocompletion),enableLiveAutocompletion:Object.toBoolean(t.enableLiveAutocompletion),minLines:t.minLines,maxLines:t.maxLines,wrap:Object.toBoolean(t.useWrapMode)}}}var r={showGutter:1,useWrapMode:1,showInvisibles:0,showIndentGuides:0,useSoftTabs:1,showPrintMargin:0,disableSearch:0,theme:"chrome",mode:"javascript",firstLineNumber:1,fontSize:"small",enableSnippets:0,enableBasicAutocompletion:0,enableLiveAutocompletion:0,readonly:0,minLines:undefined,maxLines:undefined},t=Object.assign({},r,n.model.config),i=this;u()}]);angular.module("umbraco").controller("Umbraco.Community.Contentment.DataEditors.ConfigurationEditor.Controller",["$scope","$interpolate","$timeout","editorService","eventsService","localizationService","overlayService","Umbraco.Community.Contentment.Services.DevMode",function(n,t,i,r,u,f,e,o){function v(){n.model.value=n.model.value||[];Array.isArray(n.model.value)===!1&&(n.model.value=[n.model.value]);n.model.value.forEach(function(n){n.hasOwnProperty("type")&&(n.key=n.type,delete n.type)});Number.isInteger(s.maxItems)===!1&&(s.maxItems=Number.parseInt(s.maxItems)||a.maxItems);s.itemLookup={};s.allowEdit={};s.nameTemplates={};s.descriptionTemplates={};s.missingItem={};s.items.forEach(function(n){s.itemLookup[n.key]=n;s.allowEdit[n.key]=n.fields&&n.fields.length>0;n.nameTemplate&&(s.nameTemplates[n.key]=t(n.nameTemplate));n.descriptionTemplate&&(s.descriptionTemplates[n.key]=t(n.descriptionTemplate))});f.localizeMany(["contentment_missingItemName","contentment_missingItemDescription"]).then(function(n){s.missingItem.name=n[0];s.missingItem.description=n[1];s.missingItem.icon="icon-alert"});h.allowAdd=s.maxItems===0||n.model.value.length<s.maxItems;h.allowEdit=function(n){return s.allowEdit[n.key]};h.allowRemove=Object.toBoolean(s.allowRemove);h.allowSort=Object.toBoolean(s.disableSorting)===!1&&s.maxItems!==1;h.sortableOptions={axis:"y",containment:"parent",cursor:"move",disabled:h.allowSort===!1,opacity:.7,scroll:!0,tolerance:"pointer",stop:function(){c()}};h.addButtonLabelKey=s.addButtonLabelKey||"general_add";h.add=y;h.edit=p;h.populate=w;h.remove=b;h.propertyActions=[];Object.toBoolean(s.enableDevMode)&&h.propertyActions.push({labelKey:"contentment_editRawValue",icon:"brackets",method:function(){o.editValue(n.model,k)}});i(function(){l()},100)}function y(){var t=Object.toBoolean(s.allowDuplicates)?s.items:s.items.filter(t=>n.model.value.some(n=>t.key===n.key)===!1);r.open({view:s.overlayView,size:s.items.length===1?s.items[0].overlaySize:"small",config:{mode:"select",autoSelect:s.items.length===1,label:n.model.label,items:t,enableFilter:Object.toBoolean(s.enableFilter),orderBy:s.orderBy,help:s.help},value:{},submit:function(t){n.model.value.push(t);s.maxItems!==0&&n.model.value.length>=s.maxItems&&(h.allowAdd=!1);c();r.close()},close:function(){r.close()}})}function p(t){var i=n.model.value[t],u=s.itemLookup[i.key];r.open({view:s.overlayView,size:u.overlaySize,config:{mode:"edit",editor:u},value:i,submit:function(i){n.model.value[t]=i;c();r.close()},close:function(){r.close()}})}function l(){u.emit("contentment.config-editor.model",n.model)}function w(n,t,i){var u="",r;return s.itemLookup.hasOwnProperty(n.key)===!1&&s.missingItem?s.missingItem[i]||i:(i==="name"&&s.nameTemplates.hasOwnProperty(n.key)===!0&&(r=s.nameTemplates[n.key],r&&(n.value.$index=t+1,u=r(n.value),delete n.value.$index)),i==="description"&&s.descriptionTemplates.hasOwnProperty(n.key)===!0&&(r=s.descriptionTemplates[n.key],r&&(n.value.$index=t+1,u=r(n.value),delete n.value.$index)),u||s.itemLookup[n.key][i])}function b(t){f.localizeMany(["contentment_removeItemMessage","general_remove","general_cancel","contentment_removeItemButton"]).then(function(i){e.open({title:i[1],content:i[0],closeButtonLabel:i[2],submitButtonLabel:i[3],submitButtonStyle:"danger",submit:function(){n.model.value.splice(t,1);(s.maxItems===0||n.model.value.length<s.maxItems)&&(h.allowAdd=!0);c();e.close()},close:function(){e.close()}})})}function k(){h.allowAdd=s.maxItems!==0&&n.model.value.length>=s.maxItems?!1:!0;l()}function c(){n.propertyForm&&n.propertyForm.$setDirty();l()}var a={allowDuplicates:0,items:[],maxItems:0,disableSorting:0,allowRemove:1,enableFilter:0,orderBy:"name",overlayView:"",enableDevMode:0,addButtonLabelKey:"general_add",help:null},s=Object.assign({},a,n.model.config),h=this;v()}]);angular.module("umbraco").controller("Umbraco.Community.Contentment.Overlays.ConfigurationEditor.Controller",["$scope","formHelper",function(n){function e(){if(t.mode=i.mode,t.mode==="select")i.autoSelect&&i.items.length===1?u(i.items[0]):(t.title="Select "+i.label.toLowerCase()+"...",t.help=i.help,t.items=i.items,t.enableFilter=i.enableFilter,t.orderBy=i.orderBy,t.select=u);else if(t.mode==="edit"&&i.editor){var f=n.model.value||{key:"",value:{}};r(i.editor,f)}t.close=o}function r(i,r){i.overlaySize&&n.model.size!==i.overlaySize&&(n.model.size=i.overlaySize);r.value||(r.value={});t.title="Configure "+i.name;t.editor=Object.assign({},i);t.editor.fields&&t.editor.fields.length>0&&t.editor.fields.forEach(function(n){n.alias=n.key;n.value=r.value[n.key]});t.save=f}function u(n){Array.isArray(n.fields)&&n.fields.length>0?(t.mode="edit",r(n,{value:n.defaultValues||{}})):f(n)}function o(){n.model.close&&n.model.close()}function f(t){n.$broadcast("formSubmitting",{scope:n});var i={key:t.key,value:{}};t.fields&&t.fields.forEach(function(n){i.value[n.key]=n.value});n.model.submit&&n.model.submit(i)}var i=Object.assign({},{mode:"select",autoSelect:!0,label:"",items:[],editor:null,enableFilter:!1,orderBy:"name",help:null},n.model.config),t=this;e()}]);angular.module("umbraco").controller("Umbraco.Community.Contentment.DataEditors.ContentBlocks.Controller",["$scope","$q","$http","$interpolate","clipboardService","contentResource","editorService","editorState","localizationService","notificationsService","overlayService","umbRequestHelper","Umbraco.Community.Contentment.Services.DevMode",function(n,t,i,r,u,f,e,o,s,h,c,l,a){function nt(){var i=o.getCurrent(),t;for(v.currentPageId=i.id>0?i.id:i.parentId,n.model.value=n.model.value||[],n.model.value===""&&(n.model.value=[]),Array.isArray(n.model.value)===!1&&(n.model.value=[n.model.value]),v.elementTypeScaffoldCache={},v.elementTypeLookup={},v.nameTemplates={},v.contentBlockTypes.forEach(function(n){v.elementTypeLookup[n.key]=n;v.nameTemplates[n.key]=r(n.nameTemplate||"Item {{ $index }}")}),y.enablePreview=Object.toBoolean(v.enablePreview),y.allowAdd=v.maxItems===0||v.maxItems==="0"||n.model.value.length<v.maxItems,y.allowCopy=Object.toBoolean(v.allowCopy)&&u.isSupported(),y.allowEdit=Object.toBoolean(v.allowEdit),y.allowRemove=Object.toBoolean(v.allowRemove),y.allowSort=Object.toBoolean(v.disableSorting)===!1&&v.maxItems!==1&&v.maxItems!=="1",y.add=tt,y.copy=p,y.edit=it,y.remove=rt,y.populateName=k,y.sort=function(){b()},y.previews=[],y.blockActions=[],t=0;t<n.model.value.length;t++)y.blockActions.push(g(t));b();y.propertyActions=[];y.allowCopy===!0&&y.propertyActions.push({labelKey:"contentment_copyAllBlocks",icon:"documents",method:function(){for(var t=0;t<n.model.value.length;t++)p(t)}});Object.toBoolean(v.enableDevMode)===!0&&y.propertyActions.push({labelKey:"contentment_editRawValue",icon:"brackets",method:function(){a.editValue(n.model,function(){})}})}function g(n){var t=[];return y.allowCopy===!0&&t.push({labelKey:"contentment_copyContentBlock",icon:"documents",method:function(){p(n)}}),Object.toBoolean(v.allowCreateContentTemplate)===!0&&t.push({labelKey:"contentment_createContentTemplate",icon:"blueprint",method:function(){ut(n)}}),t}function tt(){e.open({config:{elementTypes:v.contentBlockTypes,enableFilter:v.enableFilter,currentPageId:v.currentPageId},size:v.contentBlockTypes.length===1?v.contentBlockTypes[0].overlaySize:"small",value:null,view:v.overlayView,submit:function(t){n.model.value.push(t);var i=n.model.value.length-1;y.blockActions.push(g(i));w(i);v.maxItems!==0&&v.maxItems!=="0"&&n.model.value.length>=v.maxItems&&(y.allowAdd=!1);d();e.close()},close:function(){e.close()}})}function p(i){var e=n.model.value[i],r=v.elementTypeLookup[e.elementType],o=k(e,i),s=v.elementTypeScaffoldCache.hasOwnProperty(r.alias)===!1?f.getScaffold(v.currentPageId,r.alias):t.when(v.elementTypeScaffoldCache[r.alias]);s.then(function(n){var i,s,f,t;if(v.elementTypeScaffoldCache.hasOwnProperty(r.alias)===!1&&(v.elementTypeScaffoldCache[r.alias]=n),n.name=o,n.variants[0].name=o,e.value)for(i=0;i<n.variants[0].tabs.length;i++)for(s=n.variants[0].tabs[i],f=0;f<s.properties.length;f++)t=s.properties[f],e.value.hasOwnProperty(t.alias)&&(t.propertyAlias=t.alias,t.value=e.value[t.alias]);u.copy("elementType",r.alias,n)})}function it(t){var i=n.model.value[t],r=v.elementTypeLookup[i.elementType];e.open({config:{elementType:r,currentPageId:v.currentPageId},size:r.overlaySize,value:i,view:v.overlayView,submit:function(i){n.model.value[t]=i;w(t);d();e.close()},close:function(){e.close()}})}function w(t){if(y.enablePreview===!0){var r=n.model.value[t];v.elementTypeLookup[r.elementType].previewEnabled&&(y.previews[r.key]={loading:!0},l.resourcePromise(i.post("backoffice/Contentment/ContentBlocksApi/GetPreviewMarkup",r,{params:{elementIndex:t,elementKey:r.key,contentId:v.currentPageId}}),"Failed to retrieve preview markup").then(function(n){n&&n.elementKey&&n.markup&&(y.previews[n.elementKey]={loading:!1,markup:n.markup})}))}}function b(){if(y.enablePreview===!0)for(var t=0;t<n.model.value.length;t++)w(t)}function k(n,t){var i="",r=v.nameTemplates[n.elementType];return r?(n.value.$index=t+1,i=r(n.value),delete n.value.$index):i=v.elementTypeLookup[n.elementType].name,i}function rt(t){s.localizeMany(["contentment_removeItemMessage","general_remove","general_cancel","contentment_removeItemButton"]).then(function(i){c.open({title:i[1],content:i[0],closeButtonLabel:i[2],submitButtonLabel:i[3],submitButtonStyle:"danger",submit:function(){n.model.value.splice(t,1);y.blockActions.pop();b();(v.maxItems===0||v.maxItems==="0"||n.model.value.length<v.maxItems)&&(y.allowAdd=!0);d();c.close()},close:function(){c.close()}})})}function ut(t){s.localizeMany(["blueprints_createBlueprintFrom","blueprints_blueprintDescription","blueprints_createdBlueprintHeading","blueprints_createdBlueprintMessage","general_cancel","general_create"]).then(function(i){var r=n.model.value[t],u=k(r,t),e=v.elementTypeLookup[r.elementType];c.open({disableBackdropClick:!0,title:s.tokenReplace(i[0],[u]),description:i[1],blueprintName:u,view:"/App_Plugins/Contentment/editors/content-blocks.blueprint.html",closeButtonLabel:i[4],submitButtonLabel:i[5],submitButtonStyle:"action",submit:function(n){delete n.error;n.submitButtonState="busy";var t={save:!0,name:n.blueprintName,tabs:[{properties:Object.entries(r.value).map(n=>({id:0,alias:n[0],value:n[1]}))}]},o={action:"saveNew",id:0,parentId:-1,contentTypeAlias:e.alias,expireDate:null,releaseDate:null,templateAlias:null,variants:[Object.assign({},t,{save:!0})]};f.saveBlueprint(o,!0,[],!1).then(function(t){n.submitButtonState="success";h.success(i[2],s.tokenReplace(i[3],[u]));e.blueprints.push({id:t.id,name:t.variants[0].name});c.close()},function(t){n.submitButtonState="error";n.error=t.data.ModelState.Name[0]})},close:function(){c.close()}})})}function d(){n.propertyForm&&n.propertyForm.$setDirty()}var v=Object.assign({},{allowCopy:1,allowCreateContentTemplate:0,allowEdit:1,allowRemove:1,disableSorting:0,contentBlockTypes:[],enableFilter:0,enablePreview:0,maxItems:0,overlayView:"",enableDevMode:0},n.model.config),y=this;nt()}]);angular.module("umbraco").controller("Umbraco.Community.Contentment.Overlays.ContentBlocks.Controller",["$scope","blueprintConfig","clipboardService","contentResource",function(n,t,i,r){function h(){u.submit=y;u.close=p;f.elementType&&n.model.value?s(f.elementType,n.model.value):(u.mode="select",u.items=f.elementTypes,u.selectedElementType=null,u.clipboardItems=i.retriveDataOfType("elementType",f.elementTypes.map(function(n){return n.alias})),f.elementTypes.length>1||u.clipboardItems.length>0?(u.title="Add content",u.description="Select a content type...",u.icon="icon-page-add",u.selectBlueprint=!1,u.enableFilter=Object.toBoolean(f.enableFilter),u.select=o,u.paste=v,u.clearClipboard=c,u.prompt=!1,u.showPrompt=l,u.hidePrompt=a):f.elementTypes.length===1&&o(f.elementTypes[0]))}function c(){u.clipboardItems=[];i.clearEntriesOfType("elementType",f.elementTypes.map(function(n){return n.alias}))}function l(){u.prompt=!0}function a(){u.prompt=!1}function o(n){n.blueprints&&n.blueprints.length>0?n.blueprints.length===1&&t.skipSelect?e(n,n.blueprints[0]):(u.title="Add content",u.description="Select a content blueprint...",u.icon="icon-blueprint",u.selectBlueprint=!0,u.selectedElementType=n,u.blueprintAllowBlank=t.allowBlank,u.create=e):e(n)}function e(t,i){n.model.size=t.overlaySize;u.mode="edit";u.loading=!0;u.title="Edit content";u.description=t.name;u.icon=t.icon;u.content={elementType:t.key,icon:t.icon,key:String.CreateGuid()};var e=i&&i.id>0?r.getBlueprintScaffold(f.currentPageId,i.id):r.getScaffold(f.currentPageId,t.alias);e.then(function(n){Object.assign(u.content,n.variants[0]);u.loading=!1})}function v(t){var i=f.elementTypes.find(n=>n.alias===t.contentTypeAlias),o,r,h,u,e;if(n.model.size=i.overlaySize,o={elementType:i.key,icon:i.icon,key:String.CreateGuid(),value:{}},t.variants.length>0)for(r=0;r<t.variants[0].tabs.length;r++)for(h=t.variants[0].tabs[r],u=0;u<h.properties.length;u++)e=h.properties[u],typeof e.value!="function"&&(o.value[e.propertyAlias]=e.value);s(i,o)}function s(n,t){u.mode="edit";u.loading=!0;u.title="Edit content";u.description=n.name;u.icon=n.icon;u.content={elementType:n.key,icon:n.icon,key:t.key};r.getScaffold(f.currentPageId,n.alias).then(function(n){var i,e,r,f;if(t.value)for(i=0;i<n.variants[0].tabs.length;i++)for(e=n.variants[0].tabs[i],r=0;r<e.properties.length;r++)f=e.properties[r],t.value.hasOwnProperty(f.alias)&&(f.value=t.value[f.alias]);Object.assign(u.content,n.variants[0]);u.loading=!1})}function y(){var f,t,e,i,r;if(n.model.submit){if(n.$broadcast("formSubmitting",{scope:n}),f={elementType:u.content.elementType,key:u.content.key,icon:u.content.icon,value:{}},u.content.tabs.length>0)for(t=0;t<u.content.tabs.length;t++)for(e=u.content.tabs[t],i=0;i<e.properties.length;i++)r=e.properties[i],typeof r.value!="function"&&(f.value[r.alias]=r.value);n.model.submit(f)}}function p(){n.model.close&&n.model.close()}var f=Object.assign({},{elementType:null,elementTypes:[],enableFilter:!0,currentPageId:-2},n.model.config),u=this;h()}]);angular.module("umbraco").controller("Umbraco.Community.Contentment.DataEditors.ContentSource.Controller",["$scope","editorService","entityResource",function(n,t,i){function f(){n.model.value&&n.model.value.startsWith("umb://document/")?(r.node={},r.loading=!0,i.getById(n.model.value,"Document").then(function(n){u(n);r.loading=!1})):r.node=null;r.showHelp=!1;r.showSearch=!1;r.pick=e;r.remove=o;r.show=s;r.hide=h;r.help=c;r.clear=l}function e(){t.treePicker({idType:"udi",section:"content",treeAlias:"content",multiPicker:!1,submit:function(i){var r=i.selection[0];u(r);n.model.value=r.udi;t.close()},close:function(){t.close()}})}function o(){n.model.value=null;r.node=null}function s(){r.showSearch=!0}function h(){r.showSearch=!1}function c(){r.showHelp=!r.showHelp}function l(){r.showSearch=!1;n.model.value=null}function u(n){r.node=n;i.getUrl(n.id,"Document").then(function(n){r.node.path=n})}var a=Object.assign({},{},n.model.config),r=this;f()}]);angular.module("umbraco").controller("Umbraco.Community.Contentment.DataEditors.DataList.Editor.Controller",["$scope","editorService","localizationService","overlayService","Umbraco.Community.Contentment.Services.DevMode",function(n,t,i,r,u){function l(){n.model.value=n.model.value||[];Number.isInteger(f.maxItems)===!1&&(f.maxItems=Number.parseInt(f.maxItems)||s.maxItems);f.confirmRemoval=Object.toBoolean(f.confirmRemoval);e.allowAdd=f.maxItems===0||n.model.value.length<f.maxItems;e.focusName=!1;e.sortableOptions={axis:"y",containment:"parent",cursor:"move",opacity:.7,scroll:!0,tolerance:"pointer",stop:function(){o()}};e.notes=f.notes;e.add=a;e.blur=v;e.edit=h;e.open=y;e.remove=p;Object.toBoolean(f.enableDevMode)===!0&&n.umbProperty&&n.umbProperty.setPropertyActions([{labelKey:"contentment_editRawValue",icon:"brackets",method:h},{labelKey:"clipboard_labelForRemoveAllEntries",icon:"trash",method:function(){n.model.value=[]}}])}function a(){e.focusName=!1;n.model.value.push({icon:f.defaultIcon,name:"",value:"",description:""});o()}function v(n){(n.name&&n.value==null||n.value==="")&&(n.value=n.name.toCamelCase())}function h(){u.editValue(n.model,function(){})}function y(n){var i=n.icon.split(" ");t.iconPicker({icon:i[0],color:i[1],submit:function(i){n.icon=[i.icon,i.color].filter(n=>n).join(" ");e.focusName=!0;o();t.close()},close:function(){t.close()}})}function p(n){if(f.confirmRemoval===!0)i.localizeMany(["contentment_removeItemMessage","general_remove","general_cancel","contentment_removeItemButton"]).then(function(t){r.open({title:t[1],content:t[0],closeButtonLabel:t[2],submitButtonLabel:t[3],submitButtonStyle:"danger",submit:function(){c(n);r.close()},close:function(){r.close()}})});else c(n)}function c(t){n.model.value.splice(t,1);(f.maxItems===0||e.items.length<f.maxItems)&&(e.allowAdd=!0);o()}function o(){n.propertyForm&&n.propertyForm.$setDirty()}var s={confirmRemoval:0,defaultIcon:"icon-stop",enableDevMode:0,maxItems:0,notes:null},f=Object.assign({},s,n.model.config),e=this;l()}]);angular.module("umbraco").controller("Umbraco.Community.Contentment.DataEditors.DataList.Preview.Controller",["$scope","$http","eventsService","umbRequestHelper",function(n,t,i,r){function e(){u.property={};u.state="loading";u.tabs=[{label:"Editor preview",alias:"listEditor",active:!1},{label:"Data source items",alias:"dataSource",active:!1},{label:"JSON",alias:"rawJson",active:!1}];u.tabs[0].active=!0;u.activeTab=u.tabs[0].alias;u.changeTab=function(n){u.tabs.forEach(function(n){n.active=!1});u.activeTab=n.alias;n.active=!0};var t=[];t.push(i.on("contentment.config-editor.model",function(n,t){f[t.alias]=t.value;o()}));n.$on("$destroy",function(){for(var n in t)i.unsubscribe(t[n])})}function o(){_.isEmpty(f.dataSource)===!1&&_.isEmpty(f.listEditor)===!1?(u.state="loading",u.property=null,r.resourcePromise(t.post("backoffice/Contentment/DataListApi/GetPreview",f),"Failed to retrieve data list preview.").then(function(n){u.property=n;u.state=n.config.items&&n.config.items.length>0?"loaded":"noItems";u.tabs[1].label="Data source items ("+n.config.items.length+")"})):u.state=_.isEmpty(f.dataSource)===!1?"dataSourceConfigured":_.isEmpty(f.listEditor)===!1?"listEditorConfigured":"init"}var f=Object.assign({alias:n.model.alias},n.model.config),u=this;e()}]);angular.module("umbraco").controller("Umbraco.Community.Contentment.DataEditors.DataTable.Controller",["$scope","Umbraco.Community.Contentment.Services.DevMode",function(n,t){function e(){n.model.value=n.model.value||[];Number.isInteger(r.maxItems)===!1&&(r.maxItems=Number.parseInt(r.maxItems)||f.maxItems);i.headings=r.fields.map(function(n){return n.label});i.items=[];n.model.value.forEach(function(t,u){var f=[];r.fields.forEach(function(i,r){f.push(Object.assign({alias:[n.model.alias,u,r].join("_"),value:t[i.key]},i))});i.items.push(f)});i.styleTable={"max-width":Object.toBoolean(r.restrictWidth)?"800px":"100%","background-color":"#f6f4f4"};i.styleButton=Object.toBoolean(r.restrictWidth)?{}:{"max-width":"100%"};i.usePrevalueEditors=Object.toBoolean(r.usePrevalueEditors)?!0:null;i.allowAdd=r.maxItems===0||i.items.length<r.maxItems;i.allowRemove=!0;i.sortable=Object.toBoolean(r.disableSorting)===!1&&r.maxItems!==1;i.sortableOptions={axis:"y",containment:"parent",cursor:"move",disabled:i.sortable===!1,forcePlaceholderSize:!0,handle:".handle",helper:function(n,t){return t.children().each(function(){$(this).width($(this).width())}),t.clone()},items:"> tr",opacity:.7,scroll:!0,tolerance:"pointer",stop:function(){u()}};i.showPrompt=c;i.hidePrompt=l;i.add=o;i.remove=h;n.umbProperty&&n.umbProperty.setPropertyActions([{labelKey:"contentment_editRawValue",icon:"brackets",method:function(){t.editValue(n.model,function(){})}},{labelKey:"clipboard_labelForRemoveAllEntries",icon:"trash",method:function(){s()}}])}function o(){i.items.push(angular.copy(r.fields));r.maxItems!==0&&i.items.length>=r.maxItems&&(i.allowAdd=!1);u()}function s(){i.items=[];n.model.value=[];u()}function h(n){i.items.splice(n,1);(r.maxItems===0||i.items.length<r.maxItems)&&(i.allowAdd=!0);u()}function c(n){n.prompt=!0}function l(n){delete n.prompt}function u(){n.propertyForm&&n.propertyForm.$setDirty()}var f={fields:[],disableSorting:0,maxItems:0,restrictWidth:0,usePrevalueEditors:1},r=Object.assign({},f,n.model.config),i=this,a=n.$on("formSubmitting",function(){n.model.value=[];i.items.forEach(function(t){var i={};t.forEach(function(n){i[n.key]=n.value});n.model.value.push(i)})});n.$on("$destroy",function(){a()});e()}]);angular.module("umbraco").controller("Umbraco.Community.Contentment.DataEditors.DictionaryPicker.Controller",["$scope","entityResource","editorService",function(n,t,i){function o(){n.model.value=n.model.value||[];Number.isInteger(r.maxItems)===!1&&(r.maxItems=Number.parseInt(r.maxItems)||f.maxItems);u.defaultIcon="";u.allowAdd=r.maxItems===0||r.maxItems==="0"||n.model.value.length<r.maxItems;u.allowSort=Object.toBoolean(r.disableSorting)===!1&&r.maxItems!==1;u.add=s;u.remove=h}function s(){i.treePicker({section:"translation",treeAlias:"dictionary",entityType:"dictionary",multiPicker:!1,title:"Dictionary item",emptyStateMessage:"No dictionary items to choose from",select:function(t){n.model.value.push({id:t.id,name:t.name});r.maxItems!==0&&r.maxItems!=="0"&&n.model.value.length>=r.maxItems&&(u.allowAdd=!1);e();i.close()},close:function(){i.close()}})}function h(t){n.model.value.splice(t,1);(r.maxItems===0||n.model.value.length<r.maxItems)&&(u.allowAdd=!0);e()}function e(){n.propertyForm&&n.propertyForm.$setDirty()}var f={maxItems:0,disableSorting:0},r=Object.assign({},f,n.model.config),u=this;o()}]);angular.module("umbraco").controller("Umbraco.Community.Contentment.DataEditors.DropdownList.Controller",["$scope",function(n){function r(){i.showEmpty=Object.toBoolean(i.allowEmpty);t.items=i.items.slice();n.model.value=n.model.value||i.defaultValue;Array.isArray(n.model.value)?n.model.value=n.model.value[0]:i.showEmpty===!1&&n.model.value===""&&t.items.length>0&&(n.model.value=t.items[0].value);t.showEmpty=i.showEmpty===!0&&t.items.some(t=>t.value===n.model.value);t.htmlAttributes=i.htmlAttributes;t.uniqueId=n.model.hasOwnProperty("dataTypeKey")?[n.model.alias,n.model.dataTypeKey.substring(0,8)].join("-"):n.model.alias;t.change=u}function u(){t.showEmpty=i.showEmpty===!0&&t.items.some(t=>t.value===n.model.value)}var i=Object.assign({},{items:[],allowEmpty:1,defaultValue:"",htmlAttributes:[]},n.model.config),t=this;r()}]);angular.module("umbraco").controller("Umbraco.Community.Contentment.DataEditors.IconPicker.Controller",["$scope","editorService",function(n,t){function f(){n.model.value=n.model.value||r.defaultIcon;i.label=n.model.value.replace(" ","<br>");i.size=r.size;i.allowAdd=n.model.value==="";i.pick=e;i.remove=o}function e(){var r=n.model.value.split(" "),f={icon:r[0],color:r[1],submit:function(r){n.model.value=[r.icon,r.color].filter(n=>n).join(" ");i.label=n.model.value.replace(" ","<br>");i.allowAdd=!1;u();t.close()},close:function(){t.close()}};t.iconPicker(f)}function o(){n.model.value="";i.label="";i.allowAdd=!0;u()}function u(){n.propertyForm&&n.propertyForm.$setDirty()}var r=Object.assign({},{defaultIcon:"",size:"large"},n.model.config),i=this;f()}]);angular.module("umbraco").controller("Umbraco.Community.Contentment.DataEditors.ItemPicker.Controller",["$scope","editorService","focusService","localizationService","overlayService",function(n,t,i,r,u){function l(){if(n.model.value=n.model.value||f.defaultValue,Array.isArray(n.model.value)===!1&&(n.model.value=[n.model.value]),Number.isInteger(f.maxItems)===!1&&(f.maxItems=Number.parseInt(f.maxItems)||h.maxItems),f.confirmRemoval=Object.toBoolean(f.confirmRemoval),f.enableMultiple=Object.toBoolean(f.enableMultiple)&&f.maxItems!==1,e.defaultIcon=f.defaultIcon,e.allowAdd=f.maxItems===0||n.model.value.length<f.maxItems,e.allowEdit=!1,e.allowRemove=!0,e.allowSort=Object.toBoolean(f.disableSorting)===!1&&f.maxItems!==1,e.addButtonLabelKey=f.addButtonLabelKey||"general_add",e.add=a,e.remove=y,e.sort=function(){n.model.value=e.items.map(function(n){return n.value})},e.items=[],n.model.value.length>0&&f.items.length>0){var t=[];n.model.value.forEach(function(n){var i=f.items.find(t=>t.value===n);i?e.items.push(Object.assign({},i)):t.push(n)});t.length>0&&(n.model.value=_.difference(n.model.value,t),(f.maxItems===0||n.model.value.length<f.maxItems)&&(e.allowAdd=!0))}n.umbProperty&&(e.propertyActions=[],Object.toBoolean(f.allowClear)===!0&&e.propertyActions.push({labelKey:"buttons_clearSelection",icon:"trash",method:v}),e.propertyActions.length>0&&n.umbProperty.setPropertyActions(e.propertyActions))}function a(){i.rememberFocus();var r=Object.toBoolean(f.allowDuplicates)?f.items:f.items.filter(n=>e.items.some(t=>n.value===t.value)===!1);t.open({config:{title:"Choose...",enableFilter:Object.toBoolean(f.enableFilter),enableMultiple:f.enableMultiple,defaultIcon:f.defaultIcon,items:r,listType:f.listType,orderBy:f.overlayOrderBy,maxItems:f.maxItems===0?f.maxItems:f.maxItems-e.items.length},view:f.overlayView,size:f.overlaySize||"small",submit:function(i){typeof n.model.value=="string"&&(n.model.value=n.model.value.length>0?[n.model.value]:f.defaultValue);i.forEach(function(t){e.items.push(angular.copy(t));n.model.value.push(t.value)});f.maxItems!==0&&n.model.value.length>=f.maxItems&&(e.allowAdd=!1);t.close();o();s()},close:function(){t.close();s()}})}function v(){e.items=[];n.model.value=[];o()}function y(n){if(i.rememberFocus(),f.confirmRemoval===!0)r.localizeMany(["contentment_removeItemMessage","general_remove","general_cancel","contentment_removeItemButton"]).then(function(t){u.open({title:t[1],content:t[0],closeButtonLabel:t[2],submitButtonLabel:t[3],submitButtonStyle:"danger",submit:function(){c(n);u.close()},close:function(){u.close();s()}})});else c(n)}function c(t){e.items.splice(t,1);n.model.value.splice(t,1);(f.maxItems===0||n.model.value.length<f.maxItems)&&(e.allowAdd=!0);o()}function o(){n.propertyForm&&n.propertyForm.$setDirty()}function s(){var n=i.getLastKnownFocus();n&&n.focus()}var h={allowClear:0,allowDuplicates:0,confirmRemoval:0,defaultIcon:"icon-science",defaultValue:[],disableSorting:0,enableFilter:1,enableMultiple:0,items:[],maxItems:0,listType:"grid",overlayView:"",overlayOrderBy:"name",overlaySize:"small",addButtonLabelKey:"general_add"},f=Object.assign({},h,n.model.config),e=this;l()}]);angular.module("umbraco").controller("Umbraco.Community.Contentment.Overlays.ItemPicker.Controller",["$scope",function(n){function u(){t.title=i.title;t.enableFilter=i.enableFilter;t.enableMultiple=i.enableMultiple;t.defaultIcon=i.defaultIcon;t.items=i.items;t.listType=i.listType;t.orderBy=i.orderBy;t.maxItems=i.maxItems;t.itemCount=0;t.allowSubmit=!1;t.select=f;t.submit=r;t.close=e}function f(u){u.disabled!==!0&&(t.enableMultiple===!0?(u.selected=!u.selected,t.itemCount=t.items.filter(n=>n.selected===!0).length,t.allowSubmit=t.itemCount>0&&(i.maxItems===0||t.itemCount<=i.maxItems)):(n.model.value=u,r()))}function r(){if(n.model.submit){var i=[];t.enableMultiple===!0?t.items.forEach(function(n){n.selected&&(delete n.selected,i.push(n))}):i.push(n.model.value);n.model.submit(i)}}function e(){n.model.close&&n.model.close()}var i=Object.assign({},{title:"Select...",enableFilter:!1,enableMultiple:!1,defaultIcon:"icon-science",items:[],listType:"grid",orderBy:"name",maxItems:0},n.model.config),t=this;u()}]);angular.module("umbraco").controller("Umbraco.Community.Contentment.DataEditors.MacroPicker.Controller",["$scope","entityResource","editorService","localizationService","overlayService",function(n,t,i,r,u){function s(){n.model.value=n.model.value||[];e.defaultIcon="icon-settings-alt";e.allowAdd=f.maxItems===0||f.maxItems==="0"||n.model.value.length<f.maxItems;e.allowEdit=!0;e.allowRemove=!0;e.allowSort=Object.toBoolean(f.disableSorting)===!1&&f.maxItems!==1&&f.maxItems!=="1";e.addButtonLabelKey=f.addButtonLabelKey||"defaultdialogs_selectMacro";e.add=h;e.edit=c;e.remove=l;e.populateDescription=a}function h(){i.macroPicker({dialogData:{richTextEditor:!1,macroData:{macroAlias:""},allowedMacros:f.availableMacros},submit:function(t){n.model.value.push({udi:t.selectedMacro.udi,name:t.selectedMacro.name,alias:t.selectedMacro.alias,params:_.object(_.map(t.macroParams,function(n){return[n.alias,n.value]}))});f.maxItems!==0&&f.maxItems!=="0"&&n.model.value.length>=f.maxItems&&(e.allowAdd=!1);o();i.close()},close:function(){i.close()}})}function c(t){var r=n.model.value[t];i.macroPicker({dialogData:{richTextEditor:!1,macroData:{macroAlias:r.alias,macroParamsDictionary:r.params},allowedMacros:f.availableMacros},submit:function(r){n.model.value[t]={udi:r.selectedMacro.udi,name:r.selectedMacro.name,alias:r.selectedMacro.alias,params:_.object(_.map(r.macroParams,function(n){return[n.alias,n.value]}))};o();i.close()},close:function(){i.close()}})}function l(t){r.localizeMany(["contentment_removeItemMessage","general_remove","general_cancel","contentment_removeItemButton"]).then(function(i){u.open({title:i[1],content:i[0],closeButtonLabel:i[2],submitButtonLabel:i[3],submitButtonStyle:"danger",submit:function(){n.model.value.splice(t,1);(f.maxItems===0||f.maxItems==="0"||n.model.value.length<f.maxItems)&&(e.allowAdd=!0);o();u.close()},close:function(){u.close()}})})}function a(n){return n.alias}function o(){n.propertyForm&&n.propertyForm.$setDirty()}var f=Object.assign({},{availableMacros:[],maxItems:0,disableSorting:0,addButtonLabelKey:"defaultdialogs_selectMacro"},n.model.config),e=this;s()}]);angular.module("umbraco").controller("Umbraco.Community.Contentment.DataEditors.Notes.Controller",["$scope","Umbraco.Community.Contentment.Services.DevMode",function(n,t){function r(){Object.toBoolean(i.enableDevMode)===!0&&n.umbProperty&&n.umbProperty.setPropertyActions([{labelKey:"contentment_editRawValue",icon:"brackets",method:function(){t.editValue(n.model,u)}}])}function u(){n.propertyForm&&n.propertyForm.$setDirty()}var i=Object.assign({},{enableDevMode:0},n.model.config),f=this;r()}]);angular.module("umbraco").controller("Umbraco.Community.Contentment.DataEditors.NumberInput.Controller",["$scope",function(n){function u(){n.model.value!==0&&(n.model.value=n.model.value||t.defaultValue);i.maximum=t.maximum;i.minimum=t.minimum;i.step=t.step;i.pattern=t.umbracoDataValueType==="DECIMAL"?"[-0-9]+([,.][0-9]+)?":"[-0-9]*";i.placeholderText=t.placeholderText;var u={s:"umb-property-editor-tiny",m:"umb-property-editor-small",l:"umb-property-editor--limit-width",xl:"umb-property-editor"};i.sizeClass=u[t.size]||u[r.size];i.uniqueId=n.model.hasOwnProperty("dataTypeKey")?[n.model.alias,n.model.dataTypeKey.substring(0,8)].join("-"):n.model.alias}var r={placeholderText:null,defaultValue:null,maximum:null,minimum:null,size:"s",step:null,umbracoDataValueType:"INT"},t=Object.assign({},r,n.model.config),i=this;u()}]);angular.module("umbraco").controller("Umbraco.Community.Contentment.DataEditors.RadioButtonList.Controller",["$scope",function(n){function r(){n.model.value=n.model.value||i.defaultValue;Array.isArray(n.model.value)&&(n.model.value=n.model.value[0]);t.items=i.items.slice();t.showDescriptions=Object.toBoolean(i.showDescriptions);t.showIcons=Object.toBoolean(i.showIcons);t.uniqueId=n.model.hasOwnProperty("dataTypeKey")?[n.model.alias,n.model.dataTypeKey.substring(0,8)].join("-"):n.model.alias;n.umbProperty&&(t.propertyActions=[],Object.toBoolean(i.allowClear)===!0&&t.propertyActions.push({labelKey:"buttons_clearSelection",icon:"trash",method:function(){n.model.value=null}}),t.propertyActions.length>0&&n.umbProperty.setPropertyActions(t.propertyActions))}var i=Object.assign({},{allowClear:0,items:[],showDescriptions:0,showIcons:0,defaultValue:""},n.model.config),t=this;r()}]);angular.module("umbraco").controller("Umbraco.Community.Contentment.DataEditors.RenderMacro.Controller",["$scope","$routeParams","macroResource",function(n,t,i){function u(){if(r.loading=!0,Array.isArray(n.model.config.macro)&&n.model.config.macro.length>0){var u=n.model.config.macro[0];Object.assign(u.params,{__propertyAlias:n.model.alias,__propertyLabel:n.model.label,__propertyCulture:n.model.culture,__propertyDataTypeKey:n.model.dataTypeKey,__propertyDescription:n.model.description,__propertyHideLabel:n.model.hideLabel});i.getMacroResultAsHtmlForEditor(u.alias,t.id,u.params).then(function(n){r.html=n;r.loading=!1},function(n){r.error={title:n.data.Message+" "+n.errorMsg,message:n.data.ExceptionMessage};r.loading=!1})}else r.error={title:"Macro not configured",message:"This data type has not been configured. Please ensure that a macro has been selected."},r.loading=!1}if(!n.model.hasOwnProperty("contentTypeId")){var r=this;u()}}]);angular.module("umbraco").controller("Umbraco.Community.Contentment.DataEditors.Tags.Controller",["$rootScope","$scope","$element","angularHelper","assetsService","localizationService","overlayService",function(n,t,i,r,u,f,e){function v(){t.model.value=t.model.value||s.defaultValue;Array.isArray(t.model.value)===!1&&(t.model.value=[t.model.value]);s.confirmRemoval=Object.toBoolean(s.confirmRemoval);o.items=[];o.showIcons=Object.toBoolean(s.showIcons);o.uniqueId=t.model.hasOwnProperty("dataTypeKey")?["tags",t.model.alias,t.model.dataTypeKey.substring(0,8)].join("-"):["tags",t.model.alias].join("-");o.add=h;o.keyDown=p;o.keyUp=w;o.remove=l;o.loading=!0;u.loadJs("lib/typeahead.js/typeahead.bundle.min.js").then(function(){t.model.value.forEach(function(n){var t=s.items.find(t=>t.value===n);t&&o.items.push(Object.assign({},t))});o.loading=!1;var n=new Bloodhound({datumTokenizer:Bloodhound.tokenizers.obj.whitespace("name","value"),queryTokenizer:Bloodhound.tokenizers.whitespace,initialize:!1,local:s.items.filter(n=>!n.disabled),identify:n=>n.value});n.initialize().then(function(){var t={display:"name",minLength:0,source:function(t,i){t&&t.length>0?n.search(t,i):i(n.all())}};o.editor=i.find("input.typeahead").typeahead({hint:!0,highlight:!0,minLength:1},t).bind("typeahead:select",h).bind("typeahead:autocomplete",h)})});t.umbProperty&&(o.propertyActions=[],Object.toBoolean(s.allowClear)===!0&&o.propertyActions.push({labelKey:"buttons_clearSelection",icon:"trash",method:y}),o.propertyActions.length>0&&t.umbProperty.setPropertyActions(o.propertyActions))}function h(i,u){r.safeApply(n,function(){typeof t.model.value=="string"&&(t.model.value=t.model.value.length>0?[t.model.value]:s.defaultValue);o.items.push(Object.assign({},u));t.model.value.push(u.value);o.editor.typeahead("val","");c()})}function y(){o.items=[];t.model.value=[];c()}function p(n){var t,i;n.keyCode==13&&(t=o.editor.data("ttTypeahead"),t&&t.menu&&t.menu.isOpen()===!0&&(i=t.menu.getActiveSelectable()||t.menu.getTopSelectable(),t.menu.trigger("selectableClicked",i),n.preventDefault()))}function w(n,t){(n.keyCode===8||n.keyCode===46)&&l(t)}function l(n){if(s.confirmRemoval===!0)f.localizeMany(["contentment_removeItemMessage","general_remove","general_cancel","contentment_removeItemButton"]).then(function(t){e.open({title:t[1],content:t[0],closeButtonLabel:t[2],submitButtonLabel:t[3],submitButtonStyle:"danger",submit:function(){a(n);e.close()},close:function(){e.close()}})});else a(n)}function a(n){o.items.splice(n,1);t.model.value.splice(n,1);c()}function c(){t.propertyForm&&t.propertyForm.$setDirty()}var s=Object.assign({},{allowClear:0,confirmRemoval:0,defaultValue:[],items:[],showIcons:0},t.model.config),o=this;v()}]);angular.module("umbraco").controller("Umbraco.Community.Contentment.DataEditors.TemplatedList.Controller",["$scope",function(n){function u(){n.model.value=n.model.value||i.defaultValue;Array.isArray(n.model.value)===!1&&(n.model.value=[n.model.value]);t.multiple=Object.toBoolean(i.enableMultiple);t.multiple===!1&&n.model.value.length>0&&n.model.value.splice(1);t.items=i.items.slice();t.items.forEach(function(t){t.selected=n.model.value.indexOf(t.value)>-1});t.htmlAttributes=i.htmlAttributes;t.template=i.template;t.uniqueId=n.model.hasOwnProperty("dataTypeKey")?[n.model.alias,n.model.dataTypeKey.substring(0,8)].join("-"):n.model.alias;t.select=e;n.umbProperty&&(t.propertyActions=[],Object.toBoolean(i.allowClear)===!0&&t.propertyActions.push({labelKey:"buttons_clearSelection",icon:"trash",method:f}),t.propertyActions.length>0&&n.umbProperty.setPropertyActions(t.propertyActions))}function f(){n.model.value=[];t.items.forEach(n=>n.selected=!1);r()}function e(i){i.selected=i.selected===!1;n.model.value=[];t.items.forEach(function(r){t.multiple===!1&&(r.selected=r.value===i.value);r.selected&&n.model.value.push(r.value)});r()}function r(){n.propertyForm&&n.propertyForm.$setDirty()}var i=Object.assign({},{allowClear:0,defaultValue:[],enableMultiple:0,items:[],template:"{{ item.name }}",htmlAttributes:[]},n.model.config),t=this;u()}]);angular.module("umbraco").controller("Umbraco.Community.Contentment.DataEditors.TextInput.Controller",["$scope",function(n){function r(){n.model.value=n.model.value||i.defaultValue;Array.isArray(n.model.value)&&(n.model.value=n.model.value.join(", "));t.autoComplete=Object.toBoolean(i.autocomplete)?"on":"off";t.spellCheck=Object.toBoolean(i.spellcheck)?"true":"false";t.placeholderText=i.placeholderText;t.maxChars=parseInt(0+i.maxChars);t.maxCharsThreshold=t.maxChars*.8;t.uniqueId=n.model.hasOwnProperty("dataTypeKey")?[n.model.alias,n.model.dataTypeKey.substring(0,8)].join("-"):n.model.alias;i.items&&i.items.length>0&&(t.dataList=i.items,t.dataListId="dl-"+t.uniqueId)}var i=Object.assign({},{items:[],autocomplete:0,placeholderText:null,defaultValue:null,maxChars:500},n.model.config),t=this;r()}]);angular.module("umbraco.directives").component("contentmentListEditor",{templateUrl:"/App_Plugins/Contentment/components/list-editor.html",bindings:{addButtonLabel:"@?",addButtonLabelKey:"<?",allowAdd:"<?",allowEdit:"<?",allowRemove:"<?",allowSort:"<?",defaultIcon:"<?",getItem:"<?",getItemIcon:"<?",getItemName:"<?",getItemDescription:"<?",ngModel:"=",onAdd:"<?",onEdit:"<?",onRemove:"<?",onSort:"<?",propertyActions:"<?"},require:{propertyForm:"^form",umbProperty:"^"},controllerAs:"vm",controller:["$scope","localizationService",function(n,t){function r(){typeof i.onAdd=="function"&&i.onAdd()}function u(n,t){switch(typeof i.allowEdit){case"boolean":return i.allowEdit;case"function":return i.allowEdit(n,t);default:return!0}}function f(n,t){switch(typeof i.allowRemove){case"boolean":return i.allowRemove;case"function":return i.allowRemove(n,t);default:return!0}}function e(n){if(typeof i.onEdit=="function")i.onEdit(n)}function o(n,t,r){if(typeof i.getItem=="function")return i.getItem(n,t,r);switch(r){case"icon":return typeof i.getItemIcon=="function"?i.getItemIcon(n,t):n.icon||i.defaultIcon;case"name":return typeof i.getItemName=="function"?i.getItemName(n,t):n.name;case"description":return typeof i.getItemDescription=="function"?i.getItemDescription(n,t):n.description;default:return n[r]}}function s(n){if(typeof i.onRemove=="function")i.onRemove(n)}var i=this;i.$onInit=function(){i.propertyAlias=i.umbProperty.property.alias;i.sortableOptions={axis:"y",containment:"parent",cursor:"move",disabled:i.allowSort===!1,opacity:.7,scroll:!0,tolerance:"pointer",stop:function(){i.onSort&&i.onSort();i.propertyForm&&i.propertyForm.$setDirty()}};i.add=r;i.canEdit=u;i.canRemove=f;i.edit=e;i.populate=o;i.remove=s;i.addButtonLabelKey&&t.localize(i.addButtonLabelKey).then(function(n){i.addButtonLabel=n});i.propertyActions&&i.propertyActions.length>0&&i.umbProperty.setPropertyActions(i.propertyActions)}}]});angular.module("umbraco.directives").component("contentmentStackEditor",{templateUrl:"/App_Plugins/Contentment/components/stack-editor.html",bindings:{addButtonLabel:"@?",addButtonLabelKey:"<?",allowAdd:"<?",allowEdit:"<?",allowRemove:"<?",allowSort:"<?",blockActions:"<?",defaultIcon:"<?",getItemIcon:"<?",getItemName:"<?",ngModel:"=?",onAdd:"<?",onEdit:"<?",onRemove:"<?",onSort:"<?",propertyActions:"<?",previews:"<?"},require:{propertyForm:"^form",umbProperty:"^"},controllerAs:"vm",controller:["$scope","localizationService",function(n,t){function r(){typeof i.onAdd=="function"&&i.onAdd()}function u(n,t){switch(typeof i.allowEdit){case"boolean":return i.allowEdit;case"function":return i.allowEdit(n,t);default:return!0}}function f(n,t){switch(typeof i.allowRemove){case"boolean":return i.allowRemove;case"function":return i.allowRemove(n,t);default:return!0}}function e(n){if(typeof i.onEdit=="function")i.onEdit(n)}function o(n,t,r){if(typeof i.getItem=="function")return i.getItem(n,t,r);switch(r){case"icon":return typeof i.getItemIcon=="function"?i.getItemIcon(n,t):n.icon||i.defaultIcon;case"name":return typeof i.getItemName=="function"?i.getItemName(n,t):n.name;case"description":return typeof i.getItemDescription=="function"?i.getItemDescription(n,t):n.description;default:return n[r]}}function s(n){if(typeof i.onRemove=="function")i.onRemove(n)}var i=this;i.$onInit=function(){i.propertyAlias=i.umbProperty.property.alias;i.sortableOptions={axis:"y",containment:"parent",cursor:"move",disabled:i.allowSort===!1,opacity:.7,scroll:!0,tolerance:"pointer",stop:function(){i.onSort&&i.onSort();i.propertyForm&&i.propertyForm.$setDirty()}};i.add=r;i.canEdit=u;i.canRemove=f;i.edit=e;i.populate=o;i.remove=s;i.addButtonLabelKey&&t.localize(i.addButtonLabelKey).then(function(n){i.addButtonLabel=n});i.propertyActions&&i.propertyActions.length>0&&i.umbProperty.setPropertyActions(i.propertyActions)}}]});angular.module("umbraco.directives").component("contentmentBlocksEditor",{templateUrl:"/App_Plugins/Contentment/components/blocks-editor.html",bindings:{addButtonLabel:"@?",addButtonLabelKey:"<?",allowAdd:"<?",allowEdit:"<?",allowRemove:"<?",allowSort:"<?",blockActions:"<?",defaultIcon:"<?",getItemIcon:"<?",getItemName:"<?",ngModel:"=?",onAdd:"<?",onEdit:"<?",onRemove:"<?",onSort:"<?",propertyActions:"<?",previews:"<?"},require:{propertyForm:"^form",umbProperty:"^"},controllerAs:"vm",controller:["$scope","localizationService",function(n,t){function r(){typeof i.onAdd=="function"&&i.onAdd()}function u(n,t){switch(typeof i.allowEdit){case"boolean":return i.allowEdit;case"function":return i.allowEdit(n,t);default:return!0}}function f(n,t){switch(typeof i.allowRemove){case"boolean":return i.allowRemove;case"function":return i.allowRemove(n,t);default:return!0}}function e(n){if(typeof i.onEdit=="function")i.onEdit(n)}function o(n,t,r){if(typeof i.getItem=="function")return i.getItem(n,t,r);switch(r){case"icon":return typeof i.getItemIcon=="function"?i.getItemIcon(n,t):n.icon||i.defaultIcon;case"name":return typeof i.getItemName=="function"?i.getItemName(n,t):n.name;case"description":return typeof i.getItemDescription=="function"?i.getItemDescription(n,t):n.description;default:return n[r]}}function s(n){if(typeof i.onRemove=="function")i.onRemove(n)}var i=this;i.$onInit=function(){i.propertyAlias=i.umbProperty.property.alias;i.sortableOptions={axis:"y",cancel:"input,textarea,select,option",classes:".blockelement--dragging",containment:"parent",cursor:"grabbing",disabled:i.allowSort===!1,distance:5,handle:".blockelement__draggable-element",opacity:.7,scroll:!0,tolerance:"pointer",stop:function(){i.onSort&&i.onSort();i.propertyForm&&i.propertyForm.$setDirty()}};i.add=r;i.canEdit=u;i.canRemove=f;i.edit=e;i.populate=o;i.remove=s;i.addButtonLabelKey&&t.localize(i.addButtonLabelKey).then(function(n){i.addButtonLabel=n});i.propertyActions&&i.propertyActions.length>0&&i.umbProperty.setPropertyActions(i.propertyActions);i.blockActions&&i.blockActions.length>0&&i.blockActions.forEach(function(n){n.forEach(function(n){t.localize(n.labelKey).then(function(t){n.label=t})})})}}]});angular.module("umbraco.services").factory("Umbraco.Community.Contentment.Services.DevMode",["$timeout","editorService",function(n,t){return{editValue:function(i,r){t.open({title:"Edit raw value",value:Utilities.toJson(i.value,!0),ace:{showGutter:!0,useWrapMode:!0,useSoftTabs:!0,theme:"chrome",mode:"javascript",advanced:{fontSize:"14px",wrap:!0},onLoad:function(t){n(function(){t.focus()})}},view:"/App_Plugins/Contentment/editors/_json-editor.html",size:"medium",submit:function(n){i.value=Utilities.fromJson(n);r&&r();t.close()},close:function(){t.close()}})}}}]);angular.module("umbraco.directives").component("leeWasHere",{template:'<img ng-src="data:image/png;base64,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" alt="Lee was here">'});angular.module("umbraco.directives.html").directive("lkHtmlAttributes",[function(){return{restrict:"A",scope:{attributes:"&lkHtmlAttributes"},link:function(n,t){var i=n.attributes();Array.isArray(i)&&i.length>0&&i.forEach(function(n){n.name==="class"?t.addClass(n.value):t.attr(n.name,n.value)})}}}]);angular.module("umbraco.directives.html").directive("lkBindHtmlTemplate",["$compile",function(n){return{restrict:"A",replace:!0,link:function(t,i,r){t.$watch(function(n){return n.$eval(r.lkBindHtmlTemplate)},function(r){i.html(r);n(i.contents())(t)})}}}]);angular.module("umbraco.filters").filter("lkNodeName",["$filter",function(n){return function(t){return Array.isArray(t)===!1?n("ncNodeName")(t):t.map(function(t){return n("ncNodeName")(t)}).join(", ")}}]);angular.module("umbraco.filters").filter("lkGroupBy",[function(){return _.memoize(function(n,t){return _.chain(n).sortBy(t).groupBy(t).value()})}]);angular.module("umbraco").controller("Umbraco.Community.Contentment.Tree.Controller",["$scope","$window","navigationService",function(n,t,i){function u(){const f="contentment";var u=Umbraco.Sys.ServerVariables.umbracoPlugins[f];r.title=u.name;r.version="v"+u.version;i.syncTree({tree:f,path:"-1"});n.$emit("$changeTitle",r.title);r.links=[{icon:"icon-fa fa-fw fa-book ",name:"Documentation",description:"How to use each of the property editors.",url:"https://github.com/leekelleher/umbraco-contentment/tree/master/docs"},{icon:"icon-fa fa-fw fa-comments-o",name:"Support forum",description:"Ask for help, the community is your friend.",url:"https://our.umbraco.com/packages/backoffice-extensions/contentment/contentment-feedback/"},{icon:"icon-fa fa-fw fa-code-fork",name:"Source code",description:"See the code, all free and open-source.",url:"https://github.com/leekelleher/umbraco-contentment"},{icon:"icon-fa fa-fw fa-bug",name:"Issue tracker",description:"Found a bug? Suggest a feature? Let me know.",url:"https://github.com/leekelleher/umbraco-contentment/issues/new/choose"},{icon:"icon-fa fa-fw fa-id-card-o",name:"License",description:"Licensed under the Mozilla Public License.",url:"https://opensource.org/licenses/MPL-2.0"}];r.subscribe=function(){return t.open("https://tinyletter.com/umbraco-contentment","newsletterWindow","scrollbars=yes,width=840,height=640"),!0};r.vote=function(n){if(n!==!1||r.nggyu)r.nggyu=!1,r.audio&&r.audio.pause();else{r.nggyu=!0;var t=function(n){return eval("for(var t=0,S='RIFF_oO_WAVEfmt "+atob("EAAAAAEAAQBAHwAAQB8AAAEACAA")+"data';++t<3e5;)S+=String.fromCharCode("+n+")")};r.audio=new Audio("data:audio/wav;base64,"+btoa(t("(t<<3)*[8/9,1,9/8,6/5,4/3,3/2,0][[0xd2d2c8,0xce4088,0xca32c8,0x8e4009][t>>14&3]>>(0x3dbe4688>>((t>>10&15)>9?18:t>>10&15)*3&7)*3&7]&255")));r.audio.play()}};r.telemetryEnabled=u.telemetry===!0}var r=this;u()}])